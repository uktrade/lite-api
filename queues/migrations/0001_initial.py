# Generated by Django 2.2 on 2019-05-30 11:54

import uuid

from django.db import migrations, models


def initialize(apps, schema_editor):
    # We can't import the Queue model directly as it may be a newer
    # version than this migration expects. We use the historical version.
    Queue = apps.get_app_config('queues').get_model('Queue')
    Team = apps.get_model('teams', 'Team')
    default_team = Team.objects.get(pk=uuid.UUID('00000000-0000-0000-0000-000000000001'))
    if not Queue.objects.all():
        Queue.objects.create(id='00000000-0000-0000-0000-000000000001',
                             name='New Cases',
                             team=default_team,
                             )


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('cases', '0001_initial'),
        ('teams', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='Queue',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.TextField(default='Untitled Queue')),
                ('team', models.ForeignKey(on_delete=models.deletion.CASCADE,
                                           to='teams.Team')),
                ('cases', models.ManyToManyField(to='cases.Case')),
            ],
        ),
        migrations.RunPython(initialize),
    ]
