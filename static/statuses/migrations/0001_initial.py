# Generated by Django 2.2.3 on 2019-07-30 18:40

from django.db import migrations, models
from static.statuses.enums import CaseStatusEnum


def get_priority(choice):
    """
    The CaseStatusEnum is used to populate the `statuses_casestatus` table
    If you want to add a status to that table, add it to the `CaseStatusEnum` and specify its priority below via a
    return
    """
    if choice[0] == CaseStatusEnum.SUBMITTED:
        return 1
    elif choice[0] == CaseStatusEnum.RESUBMITTED:
        return 2
    elif choice[0] == CaseStatusEnum.MORE_INFORMATION_REQUIRED:
        return 3
    elif choice[0] == CaseStatusEnum.UNDER_REVIEW:
        return 4
    elif choice[0] == CaseStatusEnum.UNDER_FINAL_REVIEW:
        return 5
    elif choice[0] == CaseStatusEnum.WITHDRAWN:
        return 6
    elif choice[0] == CaseStatusEnum.DECLINED:
        return 7
    elif choice[0] == CaseStatusEnum.APPROVED:
        return 8


def populate_statuses(apps, schema_editor):
    CaseStatus = apps.get_model('statuses', 'CaseStatus')

    for choice in CaseStatusEnum.choices:
        case_status = CaseStatus(id=choice[0], priority=get_priority(choice))
        case_status.save()


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='CaseStatus',
            fields=[
                ('id', models.CharField(max_length=50, blank=False, null=False, unique=True, primary_key=True)),
                ('priority', models.IntegerField()),
            ],
        ),
        migrations.RunPython(populate_statuses),
    ]
